## üîß Google Workspace MCP Server

Este √© o servidor MCP (Model Context Protocol) que implementa ferramentas para intera√ß√£o com servi√ßos do Google Workspace, como **Gmail** e **Google Calendar**, expondo fun√ß√µes utiliz√°veis por LLMs (modelos de linguagem) via protocolo MCP. Ele se comunica com o backend atrav√©s de `stdio`, sendo usado como uma "external tool server".

---

### üöÄ Como iniciar o projeto

> Requisitos:
> - Node.js >= 18
> - pnpm (ou npm/yarn)

```bash
# 1. Clone o reposit√≥rio
git clone https://github.com/seu-usuario/google-workspace-mcp-server.git
cd google-workspace-mcp-server

# 2. Instale depend√™ncias
pnpm install

# 3. Configure o .env
cp .env.example .env
# (preencha com as credenciais corretas)

# 4. Compile o projeto
pnpm build

# 5. Execute (modo CLI MCP)
node dist/index.js
```

---

### üîå Vari√°veis de ambiente `.env`

```env
GOOGLE_CLIENT_ID=seu-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=seu-client-secret
GOOGLE_REFRESH_TOKEN=token-de-atualizacao
```

> Todas essas vari√°veis s√£o obrigat√≥rias para autenticar a API do Google.

---

### üîë Como gerar as credenciais do Gmail (OAuth2)

1. Acesse: [https://console.cloud.google.com/](https://console.cloud.google.com/)
2. Crie um projeto (ou selecione um existente)
3. Ative as APIs:
   - Gmail API
   - Google Calendar API
4. Navegue para **APIs e Servi√ßos > Tela de consentimento OAuth**
   - Escolha "Interno" ou "Externo"
   - Adicione informa√ß√µes como nome do app, escopos, etc.
5. Acesse **Credenciais** e crie um novo **ID de cliente OAuth 2.0**:
   - Tipo: "Aplicativo da Web"
   - Redirecionamento tempor√°rio: `http://localhost`
6. Copie o **Client ID** e **Client Secret**

---

### üåê Como gerar o Refresh Token

Utilize um script de autoriza√ß√£o tempor√°rio (Node.js):

```ts
import { google } from 'googleapis';

const oauth2Client = new google.auth.OAuth2(
  'SEU_CLIENT_ID',
  'SEU_CLIENT_SECRET',
  'http://localhost'
);

const url = oauth2Client.generateAuthUrl({
  access_type: 'offline',
  scope: [
    'https://www.googleapis.com/auth/gmail.readonly',
    'https://www.googleapis.com/auth/gmail.send',
    'https://www.googleapis.com/auth/gmail.modify',
    'https://www.googleapis.com/auth/calendar',
  ],
});

console.log("Acesse:", url);

// Depois de autorizar, troque o code pelo refresh_token
// const { tokens } = await oauth2Client.getToken(code);
```

> Copie o `refresh_token` e adicione ao `.env`.

---

### üìÇ Estrutura do Projeto

```
google-workspace-mcp-server/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ index.ts           # Servidor principal MCP com Gmail + Calendar
‚îú‚îÄ‚îÄ .env.example             # Modelo de vari√°veis de ambiente
‚îú‚îÄ‚îÄ package.json             # Depend√™ncias e scripts
‚îî‚îÄ‚îÄ tsconfig.json            # Configura√ß√£o TypeScript
```

---

### üîä Ferramentas MCP implementadas

- `list_emails`
- `search_emails`
- `send_email`
- `modify_email`
- `list_events`
- `create_event`
- `update_event`
- `delete_event`

Cada uma dessas ferramentas define seu `inputSchema` e √© acess√°vel via chamadas `callTool` do protocolo MCP.

---

### üõ† Integra√ß√£o com o ecossistema

Este servidor MCP deve ser conectado via `StdioClientTransport` no backend (Fastify):

```ts
const transport = new StdioClientTransport({
  command: process.execPath,
  args: ["../google-workspace-mcp-server/build/index.js"]
});
```

> A comunica√ß√£o √© feita via `stdio`, como especificado pelo protocolo MCP SDK.

---

### üö´ Poss√≠veis erros comuns

- `invalid_grant`: refresh token incorreto ou expirado
- `Missing required environment variables`: faltam vari√°veis no `.env`
- `Tool not found`: ferramenta n√£o registrada no servidor

---



## üìÇ Backend MCP Chat ‚Äì Fastify + OpenAI + MCP

Este projeto √© o backend da aplica√ß√£o de chat integrada ao Model Context Protocol (MCP). Ele tem como objetivo intermediar a comunica√ß√£o entre o frontend, o modelo de linguagem (OpenAI), e ferramentas externas acess√≠veis via servidor MCP.

---

### üöº Para que serve este backend?

- Exp√µe um endpoint HTTP `/chat` para receber mensagens do frontend.
- Envia mensagens para o modelo OpenAI GPT-4 com suporte ao uso de "tools" (ferramentas externas).
- Conecta-se ao servidor MCP via `StdioClientTransport`.
- Executa chamadas a ferramentas (como Gmail, Calendar, etc.) registradas no servidor MCP.
- Retorna para o frontend uma resposta textual unificada, combinando a resposta do modelo com os resultados das ferramentas.

---

### üöÄ Como iniciar o projeto

> Requisitos:
> - Node.js >= 18
> - pnpm (ou npm/yarn)

```bash
# 1. Clone o reposit√≥rio
git clone https://github.com/seu-usuario/mcp-backend.git
cd mcp-backend

# 2. Instale as depend√™ncias
pnpm install
# ou
npm install

# 3. Configure vari√°veis de ambiente
cp .env.example .env

# 4. Compile o servidor MCP (caso esteja em modo build)
cd ../google-workspace-mcp-server
pnpm build
cd ../mcp-backend

# 5. Rode o backend
pnpm dev
# ou
npx tsx index.ts
```

> O backend estar√° dispon√≠vel em: [http://localhost:3001/chat](http://localhost:3001/chat)

---

### üîå Estrutura do Projeto

```
backend/
‚îú‚îÄ‚îÄ index.ts               # Arquivo principal (Fastify + MCP + OpenAI)
‚îú‚îÄ‚îÄ .env.example           # Vari√°veis de ambiente
‚îú‚îÄ‚îÄ package.json           # Scripts e depend√™ncias
‚îî‚îÄ‚îÄ tsconfig.json          # Configura√ß√£o TypeScript
```

---

### üìÅ Principais Depend√™ncias

- [`fastify`](https://fastify.dev/): servidor HTTP de alta performance
- [`dotenv`](https://github.com/motdotla/dotenv): gerenciamento de vari√°veis de ambiente
- [`openai`](https://www.npmjs.com/package/openai): SDK oficial da OpenAI
- [`@modelcontextprotocol/sdk`](https://www.npmjs.com/package/@modelcontextprotocol/sdk): SDK para comunica√ß√£o via MCP
- [`@fastify/cors`](https://github.com/fastify/fastify-cors): suporte CORS

---

### üîπ Endpoint `/chat`

Este √© o √∫nico endpoint exposto no backend:

#### Request
```http
POST /chat
Content-Type: application/json

{
  "message": "Qual a minha agenda de hoje?"
}
```

#### Behavior:
- O backend monta a estrutura `messages` para o modelo:
  ```ts
  const messages = [{ role: 'user', content: message }]
  ```
- Realiza a chamada `openai.chat.completions.create()` com `tools` listadas pelo MCP.
- Se houver chamadas de ferramentas (`tool_calls`), executa cada uma via:
  ```ts
  mcpClient.callTool({ name, arguments })
  ```
- Concatena todas as sa√≠das num texto √∫nico e retorna:

#### Response
```json
{
  "response": "[Tool calendar.findEvents]\nCompromissos para hoje:\n- Reuni√£o com equipe 14h\n\nAqui est√° sua agenda."
}
```

---

### üìö Vari√°veis de Ambiente (`.env`)

```env
OPENAI_API_KEY=sk-...
```

Outras vari√°veis podem ser necess√°rias dependendo da autentica√ß√£o com o servidor MCP.

---

### üõ† Faz parte do ecossistema MCP

Este backend integra com:

- üîó **Frontend React + Vite** ‚Äì Interface do usu√°rio do chat
- üõ† **Servidor MCP** ‚Äì Executa ferramentas externas via protocolo Model Context Protocol




## üìò Frontend MCP Chat ‚Äì React + Vite

Este projeto representa a interface do usu√°rio do sistema MCP (Model Context Protocol), um chat interativo que permite ao usu√°rio enviar mensagens para um modelo de linguagem (via backend Fastify) com suporte a ferramentas externas atrav√©s do protocolo MCP. Desenvolvido com **React + Vite**, este frontend implementa uma experi√™ncia de chat moderna, responsiva e integrada com rolagem autom√°tica, hist√≥rico de mensagens e controle de envio via `Enter`.

---

### üìÇ Estrutura do Projeto

```
frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx             # Componente principal do chat
‚îÇ   ‚îú‚îÄ‚îÄ App.css             # Estilos globais e componentes
‚îÇ   ‚îî‚îÄ‚îÄ main.tsx            # Ponto de entrada do React
‚îú‚îÄ‚îÄ index.html              # HTML principal
‚îú‚îÄ‚îÄ package.json            # Depend√™ncias e scripts
‚îú‚îÄ‚îÄ tsconfig.json           # Configura√ß√£o TypeScript
‚îî‚îÄ‚îÄ vite.config.ts          # Configura√ß√£o do Vite
```

---

### ‚öôÔ∏è Tecnologias Utilizadas

- [React](https://reactjs.org/) com TypeScript
- [Vite](https://vitejs.dev/) para desenvolvimento r√°pido
- [Axios](https://axios-http.com/) para requisi√ß√µes HTTP
- `useState`, `useEffect`, `useRef` para gerenciamento de estado e rolagem autom√°tica
- Integra√ß√£o com backend `http://localhost:3001/chat`

---

### üöÄ Como iniciar o projeto

> Pr√©-requisitos:
> - Node.js >= 18
> - pnpm (ou npm/yarn)

```bash
# 1. Clone o reposit√≥rio
git clone https://github.com/seu-usuario/mcp-frontend.git
cd mcp-frontend

# 2. Instale as depend√™ncias
pnpm install
# ou
npm install
# ou
yarn install

# 3. Rode o servidor de desenvolvimento
pnpm dev
# ou
npm run dev
```

> O app estar√° dispon√≠vel em: [http://localhost:5173](http://localhost:5173)

---

### üß† O que esse projeto faz

- Interface de chat que envia mensagens ao backend MCP
- Renderiza um hist√≥rico de mensagens do tipo:
  - `role: 'user'`: mensagem enviada pelo usu√°rio
  - `role: 'assistant'`: resposta do modelo (OpenAI ou outra LLM)
- Scroll autom√°tico at√© a √∫ltima mensagem
- Envio da mensagem com **Enter** (e quebra de linha com Shift+Enter)
- Layout responsivo com estiliza√ß√£o moderna (modo escuro por padr√£o)
- Otimizado para uso com servidor MCP em Node.js conectado ao backend

---

### üé≠ Fluxo da mensagem

1. Usu√°rio digita uma mensagem no `textarea`.
2. Ao pressionar Enter ou clicar em "Enviar":
   - A mensagem √© adicionada ao hist√≥rico com role `user`.
   - Uma requisi√ß√£o `POST` √© enviada para `http://localhost:3001/chat`.
   - O backend responde com o conte√∫do gerado pela LLM.
   - A resposta √© exibida abaixo da mensagem do usu√°rio.

---

### üé® Estilo

Os estilos est√£o definidos em `App.css`, com uso de:

- `chat-box`: √°rea de rolagem do chat
- `user-message` / `assistant-message`: cores diferentes para remetente
- `input-form`: campo de input e bot√£o
- `scrollIntoView`: rolagem autom√°tica para a √∫ltima mensagem

---

### üîß Ambiente de Desenvolvimento

- ‚úÖ Hot Reload com Vite
- ‚úÖ Suporte a TypeScript nativo
- ‚úÖ CSS escopado e responsivo
- ‚úÖ Ideal para integra√ß√£o com backend e servidor MCP

---

### üì¶ Scripts dispon√≠veis

```bash
pnpm dev        # Inicia o frontend com Vite
pnpm build      # Gera o build de produ√ß√£o
pnpm preview    # Serve o build localmente para teste
```

---

### üìÅ Integra√ß√£o com o Backend

Este projeto depende de um backend rodando localmente na porta `3001`, com um endpoint `/chat`. O backend deve estar preparado para:
- Receber uma mensagem no corpo da requisi√ß√£o `{ message: string }`
- Retornar uma resposta estruturada em `{ response: string }`

---

### ü™† Faz parte do ecossistema MCP

Este frontend integra com:

- üß† **[Backend Fastify](../backend)** ‚Äì Processa as requisi√ß√µes, interage com OpenAI API e MCP
- üõ† **[Servidor MCP personalizado](../mcp-server)** ‚Äì Protocolo MCP com ferramentas como Gmail/Calendar

---

